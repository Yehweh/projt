<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Online Turf Booking</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="https://cdn.pannellum.org/2.5/pannellum.css" />
  <script src="https://cdn.pannellum.org/2.5/pannellum.js"></script>
  <style>
    /* [Previous styles unchanged for brevity - copy from last version] */
    :root {
      --primary: #006FCD;
      --primary-dark: #005A9E;
      --bg: #0b1220;
      --card-bg: #111827;
      --accent: #0080FF;
      --danger: #ef4444;
      --text: #f9fafb;
      --muted: #9ca3af;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: linear-gradient(-45deg, #020617, #1e3a8a, #0f172a, #134e4a, #1e40af);
      background-size: 400% 400%;
      animation: shiftColors 12s ease infinite;
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    @keyframes shiftColors {
      0% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
      100% {
        background-position: 0% 50%;
      }
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 5vw;
      background: rgba(15, 23, 42, 0.9);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid rgba(148, 163, 184, 0.2);
      position: sticky;
      top: 0;
      z-index: 20;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 700;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      font-size: 18px;
    }

    .logo-icon {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #60A5FA, #006FCD 45%, #1E40AF);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 20px rgba(96, 165, 250, 0.6);
      font-size: 18px;
    }

    .header-actions {
      display: flex;
      gap: 12px;
      align-items: center;
    }

    .btn {
      border: none;
      cursor: pointer;
      border-radius: 999px;
      padding: 8px 16px;
      font-size: 14px;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color: #fff;
      box-shadow: 0 10px 25px rgba(0, 111, 205, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px) scale(1.02);
      box-shadow: 0 15px 35px rgba(0, 128, 255, 0.5);
      filter: brightness(1.1);
    }

    .btn-primary:active {
      transform: translateY(0) scale(0.98);
    }

    .btn-outline {
      background: transparent;
      border: 1px solid rgba(148, 163, 184, 0.6);
      color: var(--text);
    }

    .btn-outline:hover {
      background: rgba(15, 23, 42, 0.85);
      border-color: var(--primary);
      transform: translateY(-1px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    main {
      flex: 1;
      padding: 24px 5vw 40px;
    }

    .hero {
      display: grid;
      grid-template-columns: minmax(0, 1.3fr) minmax(0, 1fr);
      gap: 24px;
      align-items: center;
      margin-bottom: 24px;
    }

    .hero-text h1 {
      font-size: clamp(26px, 4vw, 34px);
      margin-bottom: 8px;
      animation: glowPulse 4s ease-in-out infinite alternate;
    }

    .hero-text p {
      color: var(--muted);
      font-size: 14px;
      max-width: 480px;
    }

    .hero-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(59, 130, 246, 0.15);
      color: #BFDBFE;
      font-size: 12px;
      margin-bottom: 10px;
    }

    .hero-card {
      position: relative;
      border-radius: 20px;
      background: radial-gradient(circle at top, #006FCD 0, #020617 65%);
      padding: 16px;
      overflow: hidden;
      box-shadow: 0 25px 60px rgba(0, 111, 205, 0.4);
      min-height: 160px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .field-animation {
      width: 100%;
      max-width: 320px;
      aspect-ratio: 16 / 10;
      border-radius: 18px;
      background: repeating-linear-gradient(
          to right,
          rgba(30, 58, 138, 0.8) 0,
          rgba(30, 58, 138, 0.8) 4px,
          rgba(15, 23, 42, 0.95) 4px,
          rgba(15, 23, 42, 0.95) 24px
        );
      border: 2px solid rgba(191, 219, 254, 0.8);
      box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.7);
      position: relative;
      overflow: hidden;
    }

    .field-ball {
      width: 14px;
      height: 14px;
      background: radial-gradient(circle at 30% 30%, #e5e7eb, #020617);
      border-radius: 999px;
      position: absolute;
      animation: moveBall 4s linear infinite;
      box-shadow: 0 0 10px rgba(248, 250, 252, 0.7);
    }

    .field-player {
      width: 16px;
      height: 16px;
      border-radius: 999px;
      background: linear-gradient(135deg, #60A5FA, #006FCD);
      position: absolute;
      animation: floatPlayer 3s ease-in-out infinite alternate;
      box-shadow: 0 0 12px rgba(96, 165, 250, 0.9);
    }

    .field-player:nth-child(2) {
      top: 56%;
      left: 18%;
    }

    .field-player:nth-child(3) {
      top: 32%;
      right: 18%;
      animation-delay: 1s;
    }

    .field-player:nth-child(4) {
      bottom: 18%;
      left: 44%;
      animation-delay: 0.4s;
    }

.turf-image-inner {
  width: 100%;
  height: 100%;
  background-size: cover;
  background-position: center;
  transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}
@keyframes glowPulse {
  from {
    text-shadow: 0 0 7px #fff, 0 0 15px #0080FF, 0 0 30px #006FCD;
  }
  to {
    text-shadow: 0 0 10px #fff, 0 0 25px #0080FF, 0 0 50px #006FCD, 0 0 70px #0080FF;
  }
}
    @keyframes moveBall {
      0% { top: 20%; left: 20%; }
      25% { top: 20%; left: 70%; }
      50% { top: 70%; left: 70%; }
      75% { top: 70%; left: 30%; }
      100% { top: 20%; left: 20%; }
    }

    @keyframes floatPlayer {
      from { transform: translateY(0); }
      to { transform: translateY(-6px); }
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 12px;
      margin-top: 8px;
    }

    .section-header h2 {
      font-size: 18px;
    }

    .section-header span {
      font-size: 12px;
      color: var(--muted);
    }

    .turf-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 16px;
    }

    .turf-card {
      background: radial-gradient(circle at top left, rgba(96, 165, 250, 0.16), transparent 55%);
      border-radius: 18px;
      padding: 10px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      position: relative;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .turf-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.6), 0 0 20px rgba(59, 130, 246, 0.2);
      border-color: rgba(59, 130, 246, 0.8);
    }

    .turf-image {
      position: relative;
      border-radius: 14px;
      overflow: hidden;
      height: 120px;
      margin-bottom: 8px;
    }

    .turf-image::before {
      content: "";
      position: absolute;
      inset: 0;
      background-image: linear-gradient(135deg, rgba(96, 165, 250, 0.3), transparent);
      mix-blend-mode: screen;
      opacity: 0.85;
      animation: pan 6s linear infinite;
      background-size: 160% 160%;
    }

    .turf-image-inner {
      width: 140%;
      height: 140%;
      position: absolute;
      top: -20%;
      left: -20%;
      background-size: cover;
      background-position: center;
      filter: saturate(1.4) contrast(1.1);
      transform: scale(1.04);
    }

    .turf-tag {
      position: absolute;
      bottom: 8px;
      left: 8px;
      background: rgba(15, 23, 42, 0.9);
      color: #BFDBFE;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .turf-price-pill {
      position: absolute;
      top: 8px;
      right: 8px;
      background: rgba(15, 23, 42, 0.88);
      color: #e5e7eb;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
      border: 1px solid rgba(148, 163, 184, 0.5);
    }

    .turf-body {
      font-size: 13px;
    }

    .turf-title-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2px;
    }

    .turf-name {
      font-weight: 600;
    }

    .turf-location {
      font-size: 11px;
      color: var(--muted);
    }

    .turf-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 4px;
      font-size: 11px;
      color: var(--muted);
    }

    .badge {
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
      border: 1px solid rgba(148, 163, 184, 0.6);
    }

    .badge-success {
      border-color: rgba(59, 130, 246, 0.9);
      color: #BFDBFE;
    }

    .floating-admin {
      position: fixed;
      bottom: 20px;
      right: 18px;
      z-index: 30;
    }

    .slot-modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.85);
      backdrop-filter: blur(12px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 40;
    }

    .slot-modal {
      background: #020617;
      border-radius: 20px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      width: min(900px, 96vw);
      max-height: 90vh;
      padding: 16px 16px 18px;
      display: grid;
      grid-template-columns: minmax(0, 1.4fr) minmax(0, 1fr);
      gap: 12px;
      box-shadow: 0 30px 80px rgba(0, 0, 0, 0.9);
    }

    .slot-modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .slot-modal-header h3 {
      font-size: 16px;
    }

    .slot-modal-header span {
      font-size: 12px;
      color: var(--muted);
    }

    .view-360-btn {
      background: var(--primary);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 999px;
      cursor: pointer;
      font-size: 12px;
      margin-bottom: 8px;
    }

    .view-360-btn:hover {
      background: var(--accent);
    }

    #panoramaSection {
      margin-bottom: 12px;
      height: 300px;
      display: none; /* Hidden by default */
    }

    #panorama {
      width: 100%;
      height: 100%;
      border-radius: 8px;
      overflow: hidden;
    }

    .close-btn {
      border-radius: 999px;
      width: 24px;
      height: 24px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: transparent;
      color: var(--muted);
      font-size: 16px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .close-btn:hover {
      background: rgba(15, 23, 42, 0.9);
      color: var(--text);
    }

    .slots-container {
      border-radius: 14px;
      background: radial-gradient(circle at top left, rgba(96, 165, 250, 0.15), #020617 65%);
      padding: 10px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      overflow: hidden;
    }

    .slots-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      color: var(--muted);
    }

    .slots-grid {
      margin-top: 4px;
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 6px;
      max-height: 280px;
      overflow: auto;
      padding-right: 2px;
    }

    .slot-pill {
      padding: 6px 6px;
      border-radius: 999px;
      font-size: 11px;
      text-align: center;
      cursor: pointer;
      border: 1px solid rgba(148, 163, 184, 0.6);
      color: var(--muted);
      background: rgba(15, 23, 42, 0.9);
      transition: all 0.15s ease;
      white-space: nowrap;
    }

    .slot-pill.free:hover {
      border-color: rgba(59, 130, 246, 0.95);
      color: #BFDBFE;
      transform: scale(1.05);
      box-shadow: 0 0 15px rgba(59, 130, 246, 0.4);
    }

    .slot-pill.selected {
      background: linear-gradient(135deg, var(--primary), var(--accent));
      border-color: transparent;
      color: #f9fafb;
      box-shadow: 0 0 20px rgba(0, 128, 255, 0.6);
      transform: scale(1.05);
    }

    .slot-pill.booked {
      background: rgba(30, 64, 175, 0.7);
      border-color: rgba(59, 130, 246, 0.8);
      color: #dbeafe;
      cursor: not-allowed;
    }

    .slot-pill.blocked {
      background: rgba(30, 41, 59, 0.9);
      border-style: dashed;
      border-color: rgba(148, 163, 184, 0.9);
      color: rgba(148, 163, 184, 0.8);
      cursor: not-allowed;
    }

    .legend {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
      font-size: 11px;
      color: var(--muted);
    }

    .legend-item {
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .legend-dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
    }

    .dot-free {
      background: linear-gradient(135deg, var(--primary), var(--accent));
    }

    .dot-booked {
      background: rgba(30, 64, 175, 0.9);
    }

    .dot-blocked {
      background: rgba(30, 41, 59, 0.9);
    }

    .booking-form {
      border-radius: 14px;
      background: radial-gradient(circle at top right, rgba(59, 130, 246, 0.18), #020617 60%);
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      min-height: 420px;
    }

    .right-panel-header {
      display: flex;
      justify-content: space-between;
      border-bottom: 1px solid rgba(148, 163, 184, 0.3);
      margin-bottom: 4px;
      padding-bottom: 6px;
    }

    .panel-tab {
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      color: var(--muted);
      transition: all 0.3s ease;
      padding: 2px 4px;
    }

    .panel-tab:hover {
      color: var(--text);
      opacity: 0.8;
    }

    .panel-tab.active {
      color: var(--text);
      position: relative;
    }

    .panel-tab.active::after {
      content: "";
      position: absolute;
      bottom: -7px;
      left: 0;
      width: 100%;
      height: 2px;
      background: var(--primary);
      border-radius: 999px;
      animation: tabSlide 0.3s ease-out;
    }

    @keyframes tabSlide {
      from { width: 0; opacity: 0; }
      to { width: 100%; opacity: 1; }
    }

    .tab-content {
      display: flex;
      flex-direction: column;
      gap: 8px;
      flex: 1;
    }

    .input-group {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    label {
      color: var(--muted);
      font-size: 11px;
      margin-left: 8px;
    }

    input,
    select {
      background: rgba(15, 23, 42, 0.9);
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      padding: 6px 12px;
      font-size: 11px;
      color: var(--muted);
      outline: none;
      transition: all 0.3s ease;
    }

    input:focus,
    select:focus {
      border-color: rgba(59, 130, 246, 0.95);
      color: #BFDBFE;
      box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.8), 0 0 15px rgba(59, 130, 246, 0.3);
      background: rgba(15, 23, 42, 1);
    }

    .openings-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      max-height: 180px;
      overflow-y: auto;
      padding-right: 4px;
      margin-bottom: 8px;
    }

    .opening-card {
      background: rgba(15, 23, 42, 0.8);
      border: 1px solid rgba(148, 163, 184, 0.3);
      border-radius: 10px;
      padding: 8px;
      font-size: 11px;
      transition: all 0.2s ease;
    }

    .opening-card:hover {
      background: rgba(30, 41, 59, 0.9);
      border-color: var(--accent);
      transform: translateX(4px);
    }

    .opening-card-header { display: flex; justify-content: space-between; font-weight: 600; color: #BFDBFE; margin-bottom: 4px; }
    .opening-card-body { display: flex; justify-content: space-between; color: var(--muted); }
    
    .join-btn {
      margin-top: 6px;
      width: 100%;
      padding: 4px;
      font-size: 10px;
      background: rgba(59, 130, 246, 0.2);
      border: 1px solid rgba(59, 130, 246, 0.4);
      color: #93C5FD;
      border-radius: 6px;
      cursor: pointer;
    }

    .post-opening-section {
      border-top: 1px dashed rgba(148, 163, 184, 0.4);
      padding-top: 8px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .post-opening-section h5 {
      font-size: 12px;
      color: #BFDBFE;
    }

    .fare-split-box {
      background: rgba(139, 92, 246, 0.1);
      border-radius: 10px;
      padding: 8px;
      font-size: 11px;
      color: #C4B5FD;
      text-align: center;
      border: 1px solid rgba(139, 92, 246, 0.2);
      font-weight: 500;
    }
  </style>
</head>
<body>
<script>
  // List your image filenames here
  const imageFolder = [
    { img: "C:\Users\cooli\Downloads\Turf_Booking-main\Turf_Booking-main\turf1.jpg" },
    { img: "C:\Users\cooli\Downloads\Turf_Booking-main\Turf_Booking-main\turf2.jpg" },
    { img: "C:\Users\cooli\Downloads\Turf_Booking-main\Turf_Booking-main\turf3.jpg" },
    { img: "C:\Users\cooli\Downloads\Turf_Booking-main\Turf_Booking-main\turf4.jpg" }
  ];

  const grid = document.getElementById('image-only-grid');
  if (grid) {
    for (let i = 0; i < imageFolder.length; i++) {
      grid.innerHTML += `
        <div class="turf-card" style="padding: 0; overflow: hidden; border: none;">
          <div class="turf-image" style="height: 220px; margin: 0;">
            <div class="turf-image-inner" style="background-image: url('${imageFolder[i].img}'); background-size: cover; background-position: center; width: 100%; height: 100%;"></div>
          </div>
        </div>
      `;
    }
  }
</script>  <header>
    <div class="logo">
      <div class="logo-icon">T</div>
      <span>TurfArena</span>
    </div>
   <div class="header-actions">
  <span id="visitCountDisplay" style="font-size:12px;color:#60A5FA;font-weight:600;margin-right:10px;">Visits: 0</span>
  <span style="font-size:12px;color:#9ca3af;">Book 24/7 turfs in 1‑hr slots</span>
  <div id="userAuthActions" style="display: flex; gap: 8px;">
    <!-- Filled by JS -->
  </div>
  <button class="btn btn-outline" onclick="openAdminLogin()">Admin</button>
</div>
  </header>

  <main>
    <section class="hero">
      <div class="hero-text">
        <div class="hero-badge">
          <span>Live slots • No double booking</span>
        </div>
        <h1>Find and book your turf in a few clicks.</h1>
        <p>Browse nearby grounds, see all time slots for today, pick multiple free 1‑hour slots, and confirm your booking with basic details.</p>
      </div>
      <div class="hero-card">
        <div class="field-animation">
          <div class="field-ball"></div>
          <div class="field-player"></div>
          <div class="field-player"></div>
          <div class="field-player"></div>
        </div>
      </div>
    </section>

    <section>
      <div class="section-header">
        <h2>Available turfs</h2>
        <span>Click a turf card to view sports and slots.</span>
      </div>

      <div class="turf-grid" id="turfGrid">
        <!-- Dynamically populated -->
      </div>
    </section>
  </main>

  <div class="floating-admin">
    <button class="btn btn-primary" onclick="openAdminLogin()">
      Admin login
    </button>
  </div>

  <div class="slot-modal-backdrop" id="slotModalBackdrop">
    <div class="slot-modal">
      <div>
        <div class="slot-modal-header">
          <div>
            <h3 id="modalTurfName">Turf name</h3>
            <span id="modalTurfMeta">Location • Sports</span>
            <button class="view-360-btn" id="view360Btn" onclick="togglePanorama()" style="display:none; margin-top:4px;">View 360° Panorama</button>
          </div>
          <button class="close-btn" onclick="closeModal()">×</button>
        </div>

        <div id="panoramaSection">
          <div id="panorama"></div>
          <p id="panoramaFallback" style="color: var(--muted); text-align: center; display: none; padding: 10px;">360° view loading...</p>
        </div>

        <div class="slots-container">
          <div class="slots-header">
            <span>
              Date:
              <span id="selectedDateText">Today</span>
            </span>
            <div class="inline" style="gap:6px;align-items:center;">
              <input type="date" id="bookingDate" />
              <span class="pill-sm">1 hr slot</span>
            </div>
          </div>

          <div class="slots-grid" id="slotsGrid"></div>

          <div class="legend">
            <div class="legend-item">
              <span class="legend-dot dot-free"></span> Free
            </div>
            <div class="legend-item">
              <span class="legend-dot dot-booked"></span> Booked
            </div>
            <div class="legend-item">
              <span class="legend-dot dot-blocked"></span> Blocked (admin)
            </div>
          </div>
        </div>
      </div>

      <div class="booking-form">
        <div class="right-panel-header">
          <span class="panel-tab active" id="tabBooking" onclick="switchTab('booking')">Booking details</span>
          <span class="panel-tab" id="tabOpenings" onclick="switchTab('openings')">Team openings</span>
        </div>

        <div id="bookingSection" class="tab-content">
          <div class="selected-slots" id="selectedSlotsText">
            Select one or more free slots on the left.
          </div>

          <div class="input-group">
            <label for="userName">Name</label>
            <input type="text" id="userName" placeholder="Enter your full name" />
          </div>

          <div class="inline">
            <div class="input-group">
              <label for="userPhone">Mobile</label>
              <input type="tel" id="userPhone" placeholder="10‑digit mobile number" />
            </div>
            <div class="input-group">
              <label for="sportType">Sport</label>
              <select id="sportType">
                <option value="">Select sport</option>
                <option>Football</option>
                <option>Cricket</option>
                <option>Badminton</option>
                <option>Basketball</option>
                <option>Multi‑sport</option>
              </select>
            </div>
          </div>

          <div class="input-group">
            <label for="paymentMode">Payment mode (dummy)</label>
            <select id="paymentMode">
              <option value="">Select payment</option>
              <option>UPI</option>
              <option>Card</option>
              <option>Pay at turf</option>
            </select>
          </div>

          <div class="price-summary">
            <span id="slotCountText">0 hrs selected</span>
            <span id="totalPriceText">Total: ₹0</span>
          </div>

          <div class="error" id="formError"></div>

          <div class="form-actions">
            <span class="secondary-link" onclick="fakeCancel()">Cancel booking</span>
            <button class="btn btn-primary" onclick="confirmBooking()">Confirm &amp; pay</button>
          </div>
        </div>

        <div id="openingsSection" class="tab-content" style="display: none;">
          <div class="openings-list" id="openingsList">
            <!-- Dynamically populated -->
          </div>

          <div class="post-opening-section">
            <h5>Post team opening</h5>
            <div class="inline">
              <div class="input-group">
                <label>Sport Required</label>
                <select id="postSport">
                  <option>Football</option>
                  <option>Cricket</option>
                  <option>Badminton</option>
                </select>
              </div>
              <div class="input-group">
                <label>Seats Available</label>
                <input type="number" id="postSeats" value="2" min="1">
              </div>
            </div>
            <div class="input-group">
              <label>Total Team Size</label>
              <input type="number" id="postTeamSize" value="10" min="1" oninput="updatePostFareSplit()">
            </div>
            <div class="fare-split-box" id="postFareSplitDisplay">
              Fare split: ₹0 / person
            </div>
            <button class="btn btn-outline" style="width:100%; justify-content:center; padding: 8px;" onclick="postOpening()">Post Opening</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="slot-modal-backdrop" id="joinModalBackdrop" style="z-index: 50;">
    <div class="slot-modal" style="grid-template-columns: 1fr; width: min(400px, 96vw); min-height: auto;">
      <div class="booking-form" style="min-height: auto; width: 100%;">
        <div class="right-panel-header" style="margin-bottom: 12px;">
          <span class="panel-tab active">Join Team Request</span>
          <button class="close-btn" onclick="closeJoinModal()">×</button>
        </div>
        <p id="joinTeamInfo" style="font-size: 11px; color: #BFDBFE; margin-bottom: 8px;"></p>
        
        <div class="input-group">
          <label for="joinName">Your Name</label>
          <input type="text" id="joinName" placeholder="Enter your name" />
        </div>
        <div class="input-group">
          <label for="joinPhone">Mobile Number</label>
          <input type="tel" id="joinPhone" placeholder="10-digit mobile" />
        </div>
        <div class="input-group">
          <label for="joinNote">Message (Optional)</label>
          <input type="text" id="joinNote" placeholder="e.g. I play as a striker" />
        </div>
        
        <div class="error" id="joinFormError" style="margin-top: 4px;"></div>
        
        <div class="form-actions" style="margin-top: 12px;">
          <span class="secondary-link" onclick="closeJoinModal()">Cancel</span>
          <button class="btn btn-primary" onclick="submitJoinRequest()">Send Request</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Load from localStorage if available, else use mock and save
    let turfData = JSON.parse(localStorage.getItem('turfData')) || {
      1: { name: "GreenLine Arena", meta: "Velachery • Football, Cricket", basePrice: 1200, panoramaUrl: "https://pannellum.org/images/alma.jpg" },
      2: { name: "Boundary Line Turf", meta: "Tambaram • Cricket box", basePrice: 800, panoramaUrl: null },
      3: { name: "SkyLine Sports Hub", meta: "OMR • Multi‑sport", basePrice: 1000, panoramaUrl: null }
    };
    
    let teamOpenings = JSON.parse(localStorage.getItem('teamOpenings')) || {
      1: [{ id: 101, sport: "Football", seats: 3, teamSize: 10, fare: 120 }],
      2: [],
      3: [{ id: 102, sport: "Cricket", seats: 5, teamSize: 11, fare: 91 }]
    };

    let bookings = JSON.parse(localStorage.getItem('bookings')) || { 1: [6, 7, 20], 2: [18, 19], 3: [5, 6, 21] };
    let blocked = JSON.parse(localStorage.getItem('blocked')) || { 1: [3], 2: [2, 3], 3: [] };

    const hours = Array.from({ length: 24 }, (_, i) => i);
    const turfImages = {
      1: ["aerial-view-grass-field-hockey.jpg", "hc-digital-9sOleIZAE54-unsplash.jpg"],
      2: ["izuddin-helmi-adnan-K5ChxJaheKI-unsplash.jpg", "nguy-n-hi-p-XHDRUHXcsl0-unsplash.jpg"],
      3: ["thomas-park-fDmpxdV69eA-unsplash.jpg", "timothy-tan-PAe2UhGo-S4-unsplash.jpg"]
    };

    let currentTurfId = null;
    let selectedSlots = [];
    let panoramaViewer = null;
    let panoramaVisible = false;

    function init() {
      trackVisits();
      renderTurfGrid();
      startAlternatingImages();
      updateUserAuthUI();
      const dateInput = document.getElementById("bookingDate");
      const today = new Date().toISOString().split("T")[0];
      dateInput.value = today;
      dateInput.min = today;
      dateInput.addEventListener("change", () => {
        const label = document.getElementById("selectedDateText");
        label.textContent = dateInput.value === today ? "Today" : dateInput.value;
        renderSlots();
      });
      renderSlots();
      updateBookingSummary();
    }

    function switchTab(tab) {
      const bookingSec = document.getElementById("bookingSection");
      const openingsSec = document.getElementById("openingsSection");
      const bookingTab = document.getElementById("tabBooking");
      const openingsTab = document.getElementById("tabOpenings");

      if (tab === 'booking') {
        bookingSec.style.display = "flex";
        openingsSec.style.display = "none";
        bookingTab.classList.add("active");
        openingsTab.classList.remove("active");
      } else {
        bookingSec.style.display = "none";
        openingsSec.style.display = "flex";
        bookingTab.classList.remove("active");
        openingsTab.classList.add("active");
        renderOpenings();
      }
    }

    function renderTurfGrid() {
      const grid = document.getElementById("turfGrid");
      grid.innerHTML = "";
      Object.entries(turfData).forEach(([id, turf]) => {
        const article = document.createElement("article");
        article.className = "turf-card";
        const img = turfImages[id] ? turfImages[id][0] : "https://via.placeholder.com/300x150";
        article.innerHTML = `
          <div class="turf-image">
            <div class="turf-image-inner" id="turf-img-${id}" style="background-image: url('${img}');"></div>
            <span class="turf-tag">${turf.meta.split(" • ")[1]}</span>
            <span class="turf-price-pill">₹${turf.basePrice}/hr</span>
          </div>
          <div class="turf-body">
            <div class="turf-title-row">
              <div class="turf-name">${turf.name}</div>
              <span class="badge badge-success">Open 24/7</span>
            </div>
            <div class="turf-location">${turf.meta.split(" • ")[0]}</div>
          </div>
        `;
        article.onclick = () => openModal(id);
        grid.appendChild(article);
      });
    }

    function openModal(turfId) {
      currentTurfId = turfId;
      const turf = turfData[turfId];
      document.getElementById("modalTurfName").textContent = turf.name;
      document.getElementById("modalTurfMeta").textContent = turf.meta;
      selectedSlots = [];
      updateBookingSummary();
      renderSlots();
      document.getElementById("formError").textContent = "";
      document.getElementById("slotModalBackdrop").style.display = "flex";
      document.getElementById("view360Btn").style.display = turf.panoramaUrl ? "inline-block" : "none";
      switchTab('booking');
    }

    function closeModal() {
      document.getElementById("slotModalBackdrop").style.display = "none";
      if (panoramaViewer) panoramaViewer.destroy();
    }

    function renderSlots() {
      const grid = document.getElementById("slotsGrid");
      grid.innerHTML = "";
      if (!currentTurfId) return;
      const bookedSlots = bookings[currentTurfId] || [];
      const blockedSlots = blocked[currentTurfId] || [];
      hours.forEach(h => {
        const btn = document.createElement("button");
        btn.className = "slot-pill " + (blockedSlots.includes(h) ? "blocked" : bookedSlots.includes(h) ? "booked" : "free");
        if (selectedSlots.includes(h)) btn.classList.add("selected");
        btn.textContent = formatHour(h);
        if (!blockedSlots.includes(h) && !bookedSlots.includes(h)) {
          btn.onclick = () => toggleSlot(h);
        }
        grid.appendChild(btn);
      });
    }

    function formatHour(h) {
      const start = h;
      const end = (h + 1) % 24;
      const fmt = (x) => {
        const hour12 = x % 12 || 12;
        const suffix = x < 12 ? "AM" : "PM";
        return hour12 + ":00 " + suffix;
      };
      return fmt(start) + " – " + fmt(end);
    }

    function toggleSlot(h) {
      const idx = selectedSlots.indexOf(h);
      if (idx > -1) selectedSlots.splice(idx, 1);
      else selectedSlots.push(h);
      renderSlots();
      updateBookingSummary();
    }

    function updateBookingSummary() {
      const count = selectedSlots.length;
      const total = count * (turfData[currentTurfId]?.basePrice || 0);
      document.getElementById("slotCountText").textContent = `${count} hr${count !== 1 ? 's' : ''} selected`;
      document.getElementById("totalPriceText").textContent = `Total: ₹${total}`;
      document.getElementById("selectedSlotsText").textContent = count ? "Selected: " + selectedSlots.map(formatHour).join(", ") : "Select one or more free slots on the left.";
      updatePostFareSplit();
    }

    function renderOpenings() {
      const list = document.getElementById("openingsList");
      list.innerHTML = "";
      const openings = teamOpenings[currentTurfId] || [];
      if (openings.length === 0) {
        list.innerHTML = '<p style="font-size:10px; color:var(--muted); text-align:center;">No openings for this turf yet.</p>';
        return;
      }
      openings.forEach(op => {
        const div = document.createElement("div");
        div.className = "opening-card";
        div.innerHTML = `
          <div class="opening-card-header"><span>${op.sport} Team</span> <span>₹${op.fare}/pp</span></div>
          <div class="opening-card-body"><span>${op.seats} spots left</span> <span>Total: ${op.teamSize}</span></div>
          <button class="join-btn" onclick="openJoinModal('${op.sport}', ${op.fare})">Request to Join</button>
        `;
        list.appendChild(div);
      });
    }

    function openJoinModal(sport, fare) {
      document.getElementById("joinTeamInfo").textContent = `Requesting to join: ${sport} Team (Fare: ₹${fare}/pp)`;
      document.getElementById("joinModalBackdrop").style.display = "flex";
      document.getElementById("joinFormError").textContent = "";
    }

    function closeJoinModal() {
      document.getElementById("joinModalBackdrop").style.display = "none";
    }

    function submitJoinRequest() {
      const name = document.getElementById("joinName").value.trim();
      const phone = document.getElementById("joinPhone").value.trim();
      const errorEl = document.getElementById("joinFormError");

      if (!name || !phone) {
        errorEl.textContent = "Please fill in your name and mobile number.";
        return;
      }

      if (!/^[6-9]\d{9}$/.test(phone)) {
        errorEl.textContent = "Enter a valid 10-digit mobile number.";
        return;
      }

      errorEl.style.color = "#60A5FA";
      errorEl.textContent = "Request sent successfully!";
      setTimeout(() => {
        closeJoinModal();
        document.getElementById("joinName").value = "";
        document.getElementById("joinPhone").value = "";
        document.getElementById("joinNote").value = "";
      }, 1500);
    }

    function updatePostFareSplit() {
      if (!currentTurfId) return;
      const size = parseInt(document.getElementById("postTeamSize").value) || 1;
      const count = selectedSlots.length || 1;
      const total = count * turfData[currentTurfId].basePrice;
      const split = Math.ceil(total / size);
      document.getElementById("postFareSplitDisplay").textContent = `Fare split: ₹${split} / person`;
    }

    function postOpening() {
      if (selectedSlots.length === 0) {
        alert("Please select at least one slot to post an opening.");
        return;
      }
      const sport = document.getElementById("postSport").value;
      const seats = parseInt(document.getElementById("postSeats").value);
      const size = parseInt(document.getElementById("postTeamSize").value);
      const fare = Math.ceil((selectedSlots.length * turfData[currentTurfId].basePrice) / size);
      
      const newOp = { id: Date.now(), sport, seats, teamSize: size, fare };
      if (!teamOpenings[currentTurfId]) teamOpenings[currentTurfId] = [];
      teamOpenings[currentTurfId].unshift(newOp);
      localStorage.setItem('teamOpenings', JSON.stringify(teamOpenings));
      renderOpenings();
      alert("Opening posted successfully!");
    }

    function startAlternatingImages() {
      let idx = 0;
      setInterval(() => {
        idx = (idx + 1) % 2;
        Object.keys(turfImages).forEach(id => {
          const el = document.getElementById(`turf-img-${id}`);
          if (el) el.style.backgroundImage = `url('${turfImages[id][idx]}')`;
        });
      }, 3000);
    }

    function trackVisits() {
      let visits = parseInt(localStorage.getItem("visitCounter")) || 0;
      localStorage.setItem("visitCounter", ++visits);
      const display = document.getElementById("visitCountDisplay");
      if (display) display.textContent = `Visits: ${visits}`;
    }

    function togglePanorama() {
      panoramaVisible = !panoramaVisible;
      const section = document.getElementById("panoramaSection");
      const btn = document.getElementById("view360Btn");
      if (panoramaVisible) {
        section.style.display = "block";
        btn.textContent = "Hide 360° Panorama";
        const turf = turfData[currentTurfId];
        panoramaViewer = pannellum.viewer('panorama', { "type": "equirectangular", "panorama": turf.panoramaUrl, "autoLoad": true });
      } else {
        section.style.display = "none";
        btn.textContent = "View 360° Panorama";
        if (panoramaViewer) panoramaViewer.destroy();
      }
    }

    function confirmBooking() {
      const errorEl = document.getElementById("formError");
      const name = document.getElementById("userName").value.trim();
      const phone = document.getElementById("userPhone").value.trim();
      const sport = document.getElementById("sportType").value;
      const pay = document.getElementById("paymentMode").value;
      if (!name || !phone || !sport || !pay || selectedSlots.length === 0) {
        errorEl.textContent = "Fill all fields and select slots.";
        return;
      }
      bookings[currentTurfId] = [...(bookings[currentTurfId] || []), ...selectedSlots];
      localStorage.setItem('bookings', JSON.stringify(bookings));
      errorEl.style.color = "#60A5FA";
      errorEl.textContent = "Booking confirmed!";
      setTimeout(() => {
        closeModal();
        renderTurfGrid();
      }, 1000);
    }

    function fakeCancel() { alert("Cancellation handled by admin."); }
        function openAdminLogin() {
          window.location.href = 'admin-login.html';
        }
    
        function openUserLogin() {
          window.location.href = 'user-login.html';
        }
    
        function updateUserAuthUI() {
          const user = JSON.parse(localStorage.getItem('currentUser'));
          const container = document.getElementById('userAuthActions');
          if (user) {
            container.innerHTML = `<button class="btn btn-primary" onclick="window.location.href='user-dashboard.html'">Profile</button>`;
          } else {
            container.innerHTML = `<button class="btn btn-primary" onclick="openUserLogin()">Login</button>`;
          }
        }
    
        window.onload = init;
  </script>
</body>
</html>
    </div>
  </div>

  <script>
    // Load from localStorage if available, else use mock and save
    let turfData = JSON.parse(localStorage.getItem('turfData')) || {
      1: {
        name: "GreenLine Arena",
        meta: "Velachery • Football, Cricket",
        basePrice: 1200,
        image: null,
        panoramaUrl: "https://pannellum.org/images/alma.jpg" // Placeholder 360 image
      },
      2: {
        name: "Boundary Line Turf",
        meta: "Tambaram • Cricket box",
        basePrice: 800,
        image: null,
        panoramaUrl: null
      },
      3: {
        name: "SkyLine Sports Hub",
        meta: "OMR • Multi‑sport",
        basePrice: 1000,
        image: null,
        panoramaUrl: null
      }
    };
    if (!localStorage.getItem('turfData')) {
      localStorage.setItem('turfData', JSON.stringify(turfData));
    }

    let bookings = JSON.parse(localStorage.getItem('bookings')) || {
      1: [6, 7, 20],
      2: [18, 19],
      3: [5, 6, 21]
    };
    if (!localStorage.getItem('bookings')) {
      localStorage.setItem('bookings', JSON.stringify(bookings));
    }

    let blocked = JSON.parse(localStorage.getItem('blocked')) || {
      1: [3],
      2: [2, 3],
      3: []
    };
    if (!localStorage.getItem('blocked')) {
      localStorage.setItem('blocked', JSON.stringify(blocked));
    }

    const hours = Array.from({ length: 24 }, (_, i) => i);
    const placeholderImage = "https://images.pexels.com/photos/399187/pexels-photo-399187.jpeg?auto=compress&cs=tinysrgb&w=800";

    const turfImages = {
      1: ["aerial-view-grass-field-hockey.jpg", "hc-digital-9sOleIZAE54-unsplash.jpg"],
      2: ["izuddin-helmi-adnan-K5ChxJaheKI-unsplash.jpg", "nguy-n-hi-p-XHDRUHXcsl0-unsplash.jpg"],
      3: ["thomas-park-fDmpxdV69eA-unsplash.jpg", "timothy-tan-PAe2UhGo-S4-unsplash.jpg"]
    };

    function startAlternatingImages() {
      let imgIndex = 0;
      setInterval(() => {
        imgIndex = (imgIndex + 1) % 2;
        Object.keys(turfImages).forEach(id => {
          const imgEl = document.getElementById(`turf-img-${id}`);
          if (imgEl) {
            imgEl.style.backgroundImage = `url('${turfImages[id][imgIndex]}')`;
          }
        });
      }, 2000);
    }

    let currentTurfId = null;
    let selectedSlots = [];
    let panoramaViewer = null;
    let panoramaVisible = false;

    let slideIndex = 0;
    function showSlides() {
      const slides = document.getElementsByClassName("slide");
      if (slides.length === 0) return;
      
      for (let i = 0; i < slides.length; i++) {
        slides[i].classList.remove("active");
      }
      
      slideIndex++;
      if (slideIndex > slides.length) {slideIndex = 1}
      
      slides[slideIndex - 1].classList.add("active");
      setTimeout(showSlides, 3000); 
    }

    function init() {
      showSlides();
      trackVisits();
      renderTurfGrid();
      startAlternatingImages();
      const dateInput = document.getElementById("bookingDate");
      const today = new Date().toISOString().split("T")[0];
      dateInput.value = today;
      dateInput.min = today;
      dateInput.addEventListener("change", () => {
        const label = document.getElementById("selectedDateText");
        label.textContent = dateInput.value === today ? "Today" : dateInput.value;
        renderSlots();
      });

      renderSlots();
      updateBookingSummary();
    }

    function renderTurfGrid() {
      const grid = document.getElementById("turfGrid");
      grid.innerHTML = "";
      Object.entries(turfData).forEach(([id, turf]) => {
        const article = document.createElement("article");
        article.className = "turf-card";
        article.setAttribute("data-turf-id", id);
        
        const imgs = turfImages[id] || [placeholderImage];
        const imageUrl = imgs[0];

        const tag = turf.meta.split(" • ")[1] || "Multi-sport";
        const location = turf.meta.split(" • ")[0] || "Chennai";
        const bookingsToday = (bookings[id] || []).length;
        article.innerHTML = `
          <div class="turf-image">
            <div class="turf-image-inner" id="turf-img-${id}" style="background-image: url('${imageUrl}');"></div>
            <span class="turf-tag">${tag}</span>
            <span class="turf-price-pill">₹${turf.basePrice} / hr</span>
          </div>
          <div class="turf-body">
            <div class="turf-title-row">
              <div>
                <div class="turf-name">${turf.name}</div>
                <div class="turf-location">${location}</div>
              </div>
              <span class="badge badge-success">Open 24/7</span>
            </div>
            <div class="turf-meta">
              <span>${tag}</span>
              <span>${bookingsToday} bookings today</span>
            </div>
          </div>
        `;
        article.addEventListener("click", () => openModal(id));
        grid.appendChild(article);
      });
    }

    function openModal(turfId) {
      currentTurfId = turfId;
      const turf = turfData[turfId];
      document.getElementById("modalTurfName").textContent = turf.name;
      document.getElementById("modalTurfMeta").textContent = turf.meta;
      selectedSlots = [];
      updateBookingSummary();
      renderSlots();
      document.getElementById("formError").textContent = "";
      const view360Btn = document.getElementById("view360Btn");
      if (turf.panoramaUrl) {
        view360Btn.style.display = "inline-block";
        console.log("Panorama URL loaded:", turf.panoramaUrl); // Debug log
      } else {
        view360Btn.style.display = "none";
        console.log("No panorama for turf", turfId); // Debug log
      }
      document.getElementById("slotModalBackdrop").style.display = "flex";
      panoramaVisible = false;
      togglePanorama(false); // Hide by default
    }

    function closeModal() {
      document.getElementById("slotModalBackdrop").style.display = "none";
      if (panoramaViewer) {
        panoramaViewer.destroy();
        panoramaViewer = null;
      }
    }

    function togglePanorama(show = !panoramaVisible) {
      panoramaVisible = show;
      const section = document.getElementById("panoramaSection");
      const btn = document.getElementById("view360Btn");
      const fallback = document.getElementById("panoramaFallback");
      if (show) {
        section.style.display = "block";
        btn.textContent = "Hide 360° Panorama";
        initPanorama();
      } else {
        section.style.display = "none";
        btn.textContent = "View 360° Panorama";
        fallback.style.display = "none";
        if (panoramaViewer) {
          panoramaViewer.destroy();
          panoramaViewer = null;
        }
      }
    }

    function initPanorama() {
      // Check if pannellum is loaded
      if (typeof pannellum === 'undefined') {
        console.error("Pannellum library not loaded!");
        const fallback = document.getElementById("panoramaFallback");
        fallback.style.display = "block";
        fallback.textContent = "360° viewer library failed to load. Please refresh the page.";
        return;
      }

      if (panoramaViewer) {
        try {
          panoramaViewer.destroy();
        } catch (e) {
          console.log("Error destroying previous viewer:", e);
        }
        panoramaViewer = null;
      }
      
      const turf = turfData[currentTurfId];
      if (!turf || !turf.panoramaUrl) {
        console.error("No panorama URL for turf", currentTurfId);
        return;
      }
      
      const fallback = document.getElementById("panoramaFallback");
      const panoramaDiv = document.getElementById("panorama");
      
      // Clear the panorama container
      panoramaDiv.innerHTML = '';
      
      console.log("Initializing panorama, data length:", turf.panoramaUrl.length);
      fallback.style.display = "block";
      fallback.textContent = "Loading 360° view...";
      
      // Small delay to ensure DOM is ready
      setTimeout(() => {
        try {
          panoramaViewer = pannellum.viewer('panorama', {
            "type": "equirectangular",
            "panorama": turf.panoramaUrl,
            "autoLoad": true,
            "showControls": true,
            "showZoomCtrl": true,
            "showFullscreenCtrl": true,
            "mouseZoom": true,
            "draggable": true,
            "keyboardZoom": true,
            "compass": false,
            "hfov": 100,
            "pitch": 0,
            "yaw": 0,
            "onLoad": () => {
              console.log("Panorama loaded successfully");
              fallback.style.display = "none";
            },
            "onError": (error) => {
              console.error("Panorama load error:", error);
              fallback.style.display = "block";
              fallback.textContent = "360° view failed to load. Try re-uploading the image.";
            }
          });
          console.log("Pannellum viewer created");
        } catch (e) {
          console.error("Pannellum init error:", e);
          fallback.style.display = "block";
          fallback.textContent = "Failed to initialize viewer: " + e.message;
        }
      }, 100);
    }

    // [Rest of script unchanged - renderSlots, formatHour, toggleSlot, updateBookingSummary, confirmBooking, fakeCancel, openAdminLogin, init]
    function renderSlots() {
      const grid = document.getElementById("slotsGrid");
      grid.innerHTML = "";
      if (!currentTurfId) return;
      const turfId = currentTurfId;
      const bookedSlots = bookings[turfId] || [];
      const blockedSlots = blocked[turfId] || [];

      hours.forEach((h) => {
        const label = formatHour(h);
        const pill = document.createElement("button");
        pill.className = "slot-pill";
        pill.textContent = label;

        if (blockedSlots.includes(h)) {
          pill.classList.add("blocked");
        } else if (bookedSlots.includes(h)) {
          pill.classList.add("booked");
        } else {
          pill.classList.add("free");
          if (selectedSlots.includes(h)) {
            pill.classList.add("selected");
          }
          pill.addEventListener("click", () => toggleSlot(h));
        }

        grid.appendChild(pill);
      });
    }

    function formatHour(h) {
      const start = h;
      const end = (h + 1) % 24;
      const fmt = (x) => {
        const hour12 = x % 12 || 12;
        const suffix = x < 12 ? "AM" : "PM";
        return hour12 + ":00 " + suffix;
      };
      return fmt(start) + " – " + fmt(end);
    }

    function toggleSlot(h) {
      const index = selectedSlots.indexOf(h);
      if (index >= 0) {
        selectedSlots.splice(index, 1);
      } else {
        selectedSlots.push(h);
        selectedSlots.sort((a, b) => a - b);
      }
      renderSlots();
      updateBookingSummary();
    }

    function updateBookingSummary() {
      const count = selectedSlots.length;
      const countText = document.getElementById("slotCountText");
      const slotsText = document.getElementById("selectedSlotsText");
      const totalText = document.getElementById("totalPriceText");

      countText.textContent = count + " hr" + (count === 1 ? "" : "s") + " selected";

      if (!currentTurfId || count === 0) {
        slotsText.textContent = "Select one or more free slots on the left.";
        totalText.textContent = "Total: ₹0";
        return;
      }

      const timeLabels = selectedSlots.map(formatHour).join(", ");
      slotsText.textContent = "Selected: " + timeLabels;

      const basePrice = turfData[currentTurfId].basePrice;
      const total = basePrice * count;
      totalText.textContent = "Total: ₹" + total;
    }

    function confirmBooking() {
      const errorEl = document.getElementById("formError");

      if (!currentTurfId) {
        errorEl.textContent = "Select a turf from the home page.";
        return;
      }

      if (selectedSlots.length === 0) {
        errorEl.textContent = "Please select at least one free slot.";
        return;
      }

      const name = document.getElementById("userName").value.trim();
      const phone = document.getElementById("userPhone").value.trim();
      const sport = document.getElementById("sportType").value;
      const payment = document.getElementById("paymentMode").value;

      if (!name || !phone || !sport || !payment) {
        errorEl.textContent = "Fill all fields and then confirm.";
        return;
      }

      if (!/^[6-9]\d{9}$/.test(phone)) {
        errorEl.textContent = "Enter a valid 10‑digit Indian mobile number.";
        return;
      }

      const turfId = currentTurfId;
      const bookedSlots = bookings[turfId] || [];
      for (const h of selectedSlots) {
        if (bookedSlots.includes(h)) {
          errorEl.textContent = "One of the selected slots was just booked. Please refresh slots.";
          return;
        }
      }

      bookings[turfId] = [...bookedSlots, ...selectedSlots];
      localStorage.setItem('bookings', JSON.stringify(bookings));
      errorEl.style.color = "#60A5FA";
      errorEl.textContent = "Booking confirmed! (Front‑end demo only; no real payment).";
      selectedSlots = [];
      updateBookingSummary();
      renderSlots();
      renderTurfGrid();
    }

    function trackVisits() {
  // Retrieve the current count from local storage, or default to 0
  let visits = parseInt(localStorage.getItem("visitCounter")) || 0;
  // Increment the count
  visits++;
  // Save the new count back to local storage
  localStorage.setItem("visitCounter", visits);
  // Update the display element
  const display = document.getElementById("visitCountDisplay");
  if (display) {
    display.textContent = `Visits: ${visits}`;
  }
}

    function fakeCancel() {
      const errorEl = document.getElementById("formError");
      errorEl.style.color = "#f87171";
      errorEl.textContent = "Cancel feature will be handled from booking history (back‑end).";
    }

    function openAdminLogin() {
      window.location.href = 'admin-login.html';
    }

    window.addEventListener("DOMContentLoaded", init);
  </script>
</body>
</html>